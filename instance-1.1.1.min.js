/*!
  instance.js v1.1.1: A lightweight javascript library to model data on the client side
  before sending it off to the server.
  Created by @adammcarth under the MIT license
*/
function validates_instance_presence(a,b){if(void 0===b||null===b||""===b||0===b||"0"===b)var c=!1;else var c=!0;return a===!0&&c===!0?!0:a===!1&&c===!1?!0:!1}function validates_instance_length(a,b){return b.length!==a?!1:!0}function validates_instance_max_length(a,b){return b.length>a?!1:!0}function validates_instance_min_length(a,b){return b.length<a?!1:!0}function validates_instance_numeric(a,b){if(/^[0-9. ]*$/g.test(b)!==!0)var c=!1;else var c=!0;return a===!0&&c===!0?!0:a===!1&&c===!1?!0:!1}function validates_instance_alphabetic(a,b){if(/^[a-zA-Z ]*$/g.test(b)!==!0)var c=!1;else var c=!0;return a===!0&&c===!0?!0:a===!1&&c===!1?!0:!1}function validates_instance_alphanumeric(a,b){if(/^[a-zA-Z0-9 ]+$/g.test(b)!==!0)var c=!1;else var c=!0;return a===!0&&c===!0?!0:a===!1&&c===!1?!0:!1}function validates_instance_spaces(a,b){if(/( )/g.test(b)!==!0)var c=!1;else var c=!0;return a===!0&&c===!0?!0:a===!1&&c===!1?!0:!1}function validates_instance_must_include(a,b){var c=new RegExp(a,"g");return c.test(b)===!1?!1:!0}function validates_instance_must_exclude(a,b){var c=new RegExp(a,"g");return c.test(b)?!1:!0}function validates_instance_starts_with(a,b){var c=new RegExp("^"+a);return c.test(b)!==!0?!1:!0}function validates_instance_ends_with(a,b){var c=new RegExp(a+"$");return c.test(b)!==!0?!1:!0}function validates_instance_email(a,b){if(/\S+@\S+\.\S+/.test(b)!==!0)var c=!1;else var c=!0;return a===!0&&c===!0?!0:a===!1&&c===!1?!0:!1}function validates_instance_regex(a,b){return a.test(b)!==!0?!1:!0}function validates_instance_url(a,b){var c=new XMLHttpRequest;c.open("GET",a+"?value="+encodeURIComponent(b),!0),c.setRequestHeader("Instance-Validation",b),c.onreadystatechange=function(){return 4===c.readyState?200!==c.status||"false"===c.responseText||"0"===c.responseText?!1:!0:void 0},c.send()}var Instance=function(a){this.attributes={},a.defaults&&(this.defaults=a.defaults,this.attributes=Object.create(this.defaults)),this.name=a.name,this.url=a.url,this.method=a.method,this.headers=a.headers,this.validations=a.validations,this.success=a.success,this.error=a.error,this.before_send=a.before_send,this.after_send=a.after_send,this.before_validation=a.before_validation,this.after_validation=a.after_validation,this.validation_failed=a.validation_failed,this.validation_passed=a.validation_passed,this.fields=[],this.elements=[],this.removeQueue=[]};Instance.prototype.ensureArray=function(a){var b=[];return"string"==typeof a?b.concat(a):a},Array.prototype.removeByValue=function(a){for(var b=0;b<this.length;b++)if(this[b]==a){this.splice(b,1);break}},Instance.prototype.add=function(a){Object.keys(a).forEach(function(b){this.attributes[b]=a[b]},this)},Instance.prototype.addField=function(a){a=this.ensureArray(a),this.fields=this.fields.concat(a)},Instance.prototype.addElement=function(a){a=this.ensureArray(a),this.elements=this.elements.concat(a)},Instance.prototype.get=function(a){var b,c;return this.fields.forEach(function(a){b=document.getElementsByName(a)[0],this.attributes[a]=void 0===b||""===b.value?void 0:b.value},this),this.elements.forEach(function(a){c=document.getElementById(a),this.attributes[a]=null===c||""===c.innerHTML?void 0:c.innerHTML},this),this.removeQueue.forEach(function(a){delete this.attributes[a],this.fields.removeByValue(a),this.elements.removeByValue(a)},this),this.removeQueue=[],a?this.attributes[a]:this.attributes},Instance.prototype.remove=function(a){a=this.ensureArray(a),this.removeQueue=this.removeQueue.concat(a)},Instance.prototype.reset=function(){this.attributes={},this.defaults&&(this.attributes=this.defaults)},Instance.prototype.clear=function(){this.attributes={}},Instance.prototype.validate=function(){var a=this.validations,b=[];if(a){this.before_validation&&this.before_validation();var c=!1;if(Object.keys(a).forEach(function(d){Object.keys(a[d]).forEach(function(e){var f=a[d][e].fail,g=a[d][e].pass;if(void 0===this.get(d)&&a[d].allow_blank===!0)g&&a[d].no_blank_callback!==!0&&b.push(g);else if(void 0===this.get(d)&&"presence"!==e){var h=!1;c=!0,f&&b.push(f)}else{var h=window["validates_instance_"+e](a[d][e].value,this.get(d));h===!1?(c=!0,f&&b.push(f)):g&&b.push(g)}},this)},this),c===!0&&this.validation_failed&&this.validation_failed(),c===!1&&this.validation_passed&&this.validation_passed(),b){for(var d=0;d<b.length;d++)b[d]();b={}}return this.after_validation&&this.after_validation(),c===!0?!1:!0}},Instance.prototype.send=function(a,b,c){if(c!==!1&&this.validate()===!1)return!1;this.before_send&&this.before_send();var d=this,e=new XMLHttpRequest,f="",g="",h=(this.get(),this.headers);e.onreadystatechange=function(){4===e.readyState&&(200===e.status?d.success(this.responseText):d.error(e.status,this.responseText))},b=b||this.method||"POST",b=b.toUpperCase(),a=a||this.url||"./",Object.keys(this.get()).forEach(function(a){f+="&",g=void 0===this.get(a)?"":encodeURIComponent(this.get(a)),f+=this.name?this.name+"["+a+"]="+g:a+"="+g},this),"GET"===b&&(a=a+"?"+f),e.open(b,a,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),h&&Object.keys(h).forEach(function(a){e.setRequestHeader(a,h[a])}),e.send(f),this.after_send&&this.after_send()};