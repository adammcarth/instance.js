/*!
  instance.js v1.0.0: A lightweight javascript library to model data on the client side
  before sending it off to the server.
  Created by @adammcarth under the MIT license
*/
(function(e){function n(e){var t=[];if(typeof e==="string"){return t.concat(e)}return e}var t=function(e){this.attributes={};if(e.defaults){this.defaults=e.defaults;this.attributes=Object.create(this.defaults)}this.name=e.name;this.url=e.url;this.method=e.method;this.headers=e.headers;this.success=e.success;this.error=e.error;this.fields=[];this.elements=[];this.removeQueue=[]};t.prototype.add=function(e){Object.keys(e).forEach(function(t){this.attributes[t]=e[t]},this)};t.prototype.addField=function(e){e=n(e);this.fields=this.fields.concat(e)};t.prototype.addElement=function(e){e=n(e);this.elements=this.elements.concat(e)};Array.prototype.removeByValue=function(e){for(var t=0;t<this.length;t++){if(this[t]==e){this.splice(t,1);break}}};t.prototype.get=function(e){var t,n;this.fields.forEach(function(e){t=document.getElementsByName(e)[0];if(t===undefined||t.value===""){this.attributes[e]=undefined}else{this.attributes[e]=t.value}},this);this.elements.forEach(function(e){n=document.getElementById(e);if(n===null||n.innerHTML===""){this.attributes[e]=undefined}else{this.attributes[e]=n.innerHTML}},this);this.removeQueue.forEach(function(e){delete this.attributes[e];this.fields.removeByValue(e);this.elements.removeByValue(e)},this);this.removeQueue=[];if(e){return this.attributes[e]}else{return this.attributes}};t.prototype.remove=function(e){e=n(e);this.removeQueue=this.removeQueue.concat(e)};t.prototype.reset=function(){this.attributes={};if(this.defaults){this.attributes=this.defaults}};t.prototype.clear=function(){this.attributes={}};t.prototype.send=function(e,t){var n=this,r=new XMLHttpRequest,i="",s="",o=this.get(),u=this.headers;r.onreadystatechange=function(){if(r.readyState===4){if(r.status===200){n.success(this.responseText)}else{n.error(r.status,this.responseText)}}};t=t||this.method||"POST";t=t.toUpperCase();e=e||this.url||"./";Object.keys(this.get()).forEach(function(e){i+="&";if(this.get(e)===undefined){s=""}else{s=encodeURIComponent(this.get(e))}if(this.name){i+=this.name+"["+e+"]"+"="+s}else{i+=e+"="+s}},this);if(t==="GET"){e=e+"?"+i}r.open(t,e,true);r.setRequestHeader("Content-type","application/x-www-form-urlencoded");if(u){Object.keys(u).forEach(function(e){r.setRequestHeader(e,u[e])})}r.send(i)};e.Instance=t})(window)